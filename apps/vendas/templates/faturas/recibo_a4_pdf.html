<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Recibo Nº {{ fatura.numero }}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        /* ==================== Estilos Base ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            line-height: 1.6;
            color: #2d3748;
            background: #ffffff;
        }

        .container {
            width: 100%;
            padding: 0.5cm;
        }

        /* ==================== Paginação e Rodapé (Adaptado do Fatura) ==================== */
        @page {
            size: A4;
            margin: 1cm;
            margin-bottom: 3cm;

            @bottom-center {
                /* Aviso legal simplificado para o Recibo */
                content: "VSTG - Processado por programa validado n.º 96/AGT/2019 | Este documento serve como Recibo de Pagamento.";
                font-family: 'Inter', sans-serif;
                font-size: 10px;
                color: #718096;
                white-space: pre;
            }

            /* Mantive rodapé padrão de usuário e página no lado esquerdo/direito */
        }

        /* ==================== Layout Recibo Específico ==================== */
        .recibo-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .recibo-title {
            font-size: 30px;
            font-weight: 700;

            color: {
                    {
                    personalizacao.cor_primaria|default: "#1a202c"
                }
            }

            ;

            border-bottom: 4px solid {
                    {
                    personalizacao.cor_primaria|default: "#48bb78"
                }
            }

            ;
            display: inline-block;
            padding: 0 10px 5px 10px;
            margin-bottom: 5px;
        }

        .recibo-number-text {
            font-size: 18px;
            font-weight: 600;

            color: {
                    {
                    personalizacao.cor_primaria|default: "#48bb78"
                }
            }

            ;
        }

        .info-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            gap: 20px;
        }

        .info-box {
            width: 48%;
            background: #f0fff4;
            /* Fundo mais claro e verde */
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #9ae6b4;
        }

        .section-title {
            font-size: 14px;
            font-weight: 700;

            color: {
                    {
                    personalizacao.cor_primaria|default: "#2f855a"
                }
            }

            ;
            margin-bottom: 10px;
            text-transform: uppercase;

            border-bottom: 2px solid {
                    {
                    personalizacao.cor_secundaria|default: "#c6f6d5"
                }
            }

            ;
            padding-bottom: 5px;
        }

        .details-item {
            font-size: 12px;
            margin-bottom: 8px;
        }

        .details-item strong {
            color: #2d3748;
            font-weight: 600;
        }

        /* ==================== Área de Totais (Pagamento) ==================== */
        .payment-area {
            text-align: center;
            margin-top: 50px;
            padding: 30px 0;
            background: #e6fffa;
            border-radius: 8px;

            border: 2px solid {
                    {
                    personalizacao.cor_primaria|default: "#48bb78"
                }
            }

            ;
        }

        .amount-title {
            font-size: 16px;
            font-weight: 600;

            color: {
                    {
                    personalizacao.cor_primaria|default: "#2f855a"
                }
            }

            ;
            margin-bottom: 10px;
        }

        .amount-value {
            font-size: 40px;
            font-weight: 700;

            color: {
                    {
                    personalizacao.cor_primaria|default: "#22543d"
                }
            }

            ;

            border-bottom: 2px dashed {
                    {
                    personalizacao.cor_primaria|default: "#48bb78"
                }
            }

            ;
            display: inline-block;
            padding-bottom: 5px;
        }

        /* ==================== Assinatura e Notas ==================== */
        .signature-area {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px dashed #a0aec0;
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: #4a5568;
        }

        .clear {
            clear: both;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="recibo-header">
            {% if personalizacao.logo %}
            <img src="{{ personalizacao.logo }}" alt="Logo da Empresa" style="max-width: 100px; margin-bottom: 10px;">
            {% endif %}
            <div class="recibo-title">{{ fatura.tipo_venda|upper }}</div>
            <div class="recibo-number-text">Nº: {{ fatura.numero }}</div>
            <p style="font-size: 12px; color: #718096; margin-top: 5px;">
                {{ empresa.razao_social|default:empresa.nome_fantasia|default:"Empresa" }} | NIF: {{
                empresa.nif|default:"N/A" }}
            </p>
        </div>

        <div class="info-section">
            <div class="info-box">
                <div class="section-title">Recebido De</div>
                <div class="details-item"><strong>Nome:</strong> {{ cliente.nome }}</div>
                <div class="details-item"><strong>NIF:</strong> {{ cliente.nif|default:"N/A" }}</div>
                <div class="details-item"><strong>Endereço:</strong> {{ cliente.endereco|default:"N/A" }}</div>
                <div class="details-item"><strong>Telefone:</strong> {{ cliente.telefone|default:"N/A" }}</div>
            </div>

            <div class="info-box">
                <div class="section-title">Detalhes da Liquidação</div>
                <div class="details-item"><strong>Data de Emissão:</strong> {{ fatura.data_emissao|date:"d/m/Y H:i" }}
                </div>
                <div class="details-item"><strong>Documento Liquidado:</strong> {{ fatura.observacoes|truncatechars:100
                    }}</div>
                <div class="details-item"><strong>Forma de Pagamento:</strong> {{ fatura.forma_pagamento|default:"N/A"
                    }}</div>
                <div class="details-item"><strong>Emissor:</strong> {{
                    request.user.get_full_name|default:request.user.username|default:'Sistema' }}</div>
            </div>
        </div>

        <div class="payment-area">
            <div class="amount-title">VALOR TOTAL RECEBIDO</div>
            <div class="amount-value">{{ totais.total|floatformat:2 }} Kz</div>
            <p style="margin-top: 15px; font-size: 12px; font-weight: 600; color: #2d3748;">
                {% comment %} Assumindo que você tem um filtro/função para converter número para extenso, se necessário.
                {% endcomment %}
                {% comment %} Exemplo: {{ totais.total|numero_por_extenso }} Kwanzas. {% endcomment %}
                {{ fatura.status|upper }}
            </p>
        </div>

        <div class="signature-area">
            <div>
                _______________________________________ <br>
                {{ empresa.razao_social|default:"Empresa" }}
            </div>
            <div style="text-align: right;">
                _______________________________________ <br>
                Assinatura do Cliente
            </div>
        </div>

        <div class="clear"></div>

        <div class="qr-code-container" style="text-align: center;">
            <p></p>

            <img src="{{ qr_code_base64 }}" alt="QR Code de Autenticação da Fatura" style="width: 150px; height: 150px;"
                style="width: 100px; height: 100px;" />

        </div>

    </div>
</body>

</html>